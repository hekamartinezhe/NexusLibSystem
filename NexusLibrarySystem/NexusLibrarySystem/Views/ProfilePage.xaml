<Page x:Class="NexusLibrarySystem.Views.ProfilePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Profile">

    <Grid Background="{StaticResource BackgroundBrush}" Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Perfil del Usuario"
                   FontSize="28"
                   FontWeight="Bold"
                   Foreground="{StaticResource PrimaryBrush}"
                   Margin="0,0,0,20"/>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Top" Width="600" Margin="0 0 0 40">

                <!-- Panel de perfil -->
                <Border CornerRadius="15"
                        Background="{StaticResource SurfaceBrush}"
                        Padding="20" Margin="0 0 0 20"
                        Effect="{StaticResource CardShadow}">
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Width="80" Height="80" Margin="0 0 20 0" StrokeThickness="2" Stroke="{StaticResource PrimaryBrush}">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="/Assets/Assets.png" />
                            </Ellipse.Fill>
                        </Ellipse>

                        <StackPanel VerticalAlignment="Center" >
                            <TextBlock Text="{Binding FullName}" FontSize="20" FontWeight="Bold" Foreground="{StaticResource OnSurfaceBrush}" />
                            <TextBlock Text="{Binding EnrollmentNum}" Foreground="{StaticResource SecondaryBrush}" />
                            <TextBlock Text="Rol: Estudiante" Foreground="{StaticResource PrimaryBrush}" />
                            <TextBlock Text="Estado de Cuenta: Activa" Foreground="Green" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <TextBlock Text="Préstamos Activos"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="{StaticResource OnBackgroundBrush}"
                           Margin="0,10"/>

                <Border Background="{StaticResource SurfaceBrush}"
                        CornerRadius="8"
                        Padding="5"
                        BorderBrush="{StaticResource PrimaryBrush}"
                        BorderThickness="1"
                        Margin="0,10,0,0">

                    <DataGrid x:Name="LoansDataGrid"
                              Style="{StaticResource DataGridStandardStyle}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              SelectionMode="Single"
                              SelectionChanged="LoansDataGrid_SelectionChanged">

                        <DataGrid.Resources>
                            <Style TargetType="DataGridColumnHeader"
                                   BasedOn="{StaticResource StandardDataGridHeaderStyle}" />
                        </DataGrid.Resources>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Título" Binding="{Binding BookTitle}" Width="*" />
                            <DataGridTextColumn Header="Fecha Préstamo" Binding="{Binding LoanDate, StringFormat={}{0:dd/MM/yyyy}}" Width="Auto" />
                            <DataGridTextColumn Header="Fecha Límite" Binding="{Binding DueDate, StringFormat={}{0:dd/MM/yyyy}}" Width="Auto" />
                            <DataGridTextColumn Header="Estado" Binding="{Binding Status}" Width="Auto" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <Button x:Name="RenewButton"
                Grid.Row="2"
                Content="Renovar Préstamo Seleccionado"
                Style="{StaticResource MaterialButton}"
                FontSize="14"
                Padding="8,4"
                Margin="0,10,0,0"
                HorizontalAlignment="Center"
                Width="220"
                IsEnabled="False"
                Click="RenewButton_Click"/>
    </Grid>
</Page>
